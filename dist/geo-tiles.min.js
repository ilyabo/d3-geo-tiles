function spiralOrder(t,n,a){var r,e,l,o,h=t.length,i=n.length,u=~~(h/2),M=~~(i/2),c=y=0,f=0,s=-1,g=Math.max(h,i);for(r=0;g*(g+1)>r;r++)e=c+u,l=-y+M,e>=0&&h>e&&l>=0&&i>l&&a(t[e],n[l]),(c===y||0>c&&c===-y||c>0&&c===1-y)&&(o=f,f=-s,s=o),c+=f,y+=s}function long2tile(t,n){return Math.floor((t+180)/360*Math.pow(2,n))}function lat2tile(t,n){return Math.floor((1-Math.log(Math.tan(t*Math.PI/180)+1/Math.cos(t*Math.PI/180))/Math.PI)/2*Math.pow(2,n))}function tile2long(t,n){return t/Math.pow(2,n)*360-180}function tile2lat(t,n){var a=Math.PI-2*Math.PI*t/Math.pow(2,n);return 180/Math.PI*Math.atan(.5*(Math.exp(a)-Math.exp(-a)))}function range(t,n){var a,r=[];for(a=t;n>a;a++)r.push(a);return r}var tiles=function(){function t(){var a=t.transform(),r=[],e=range(Math.max(0,Math.floor(-a.translate[0])),Math.max(0,Math.ceil(n[0]/a.scale-a.translate[0]))),o=range(Math.max(0,Math.floor(-a.translate[1])),Math.max(0,Math.ceil(n[1]/a.scale-a.translate[1])));return l?spiralOrder(e,o,function(t,n){r.push([t,n,a.z])}):o.forEach(function(t){e.forEach(function(n){r.push([n,t,a.z])})}),r}var n=[960,500],a=256,r=[n[0]/2,n[1]/2],e=0,l=!1;return t.transform=function(){var t=Math.max(Math.log(a)/Math.LN2-8,0),n=Math.round(t+e),l=Math.pow(2,t-n+8),o=[(r[0]-a/2)/l,(r[1]-a/2)/l];return{z:n,scale:l,translate:o}},t.size=function(a){return arguments.length?(n=a,t):n},t.scale=function(n){return arguments.length?(a=n,t):a},t.translate=function(n){return arguments.length?(r=n,t):r},t.zoomDelta=function(n){return arguments.length?(e=+n,t):e},t.spiral=function(n){return arguments.length?(l=!!n,t):l},t};tiles.locationToTile=function(t,n,a){return{x:long2tile(n,a),y:lat2tile(t,a),z:a}},tiles.tileToBoundingBox=function(t,n,a){return[[tile2long(t,a),tile2lat(n,a)],[tile2long(t+1,a),tile2lat(n+1,a)]]},module.exports=tiles;