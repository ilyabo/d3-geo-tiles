function spiralOrder(t,n,a){var r,e,o,l,h=t.length,i=n.length,u=~~(h/2),M=~~(i/2),c=y=0,f=0,g=-1,s=Math.max(h,i);for(r=0;s*(s+1)>r;r++)e=c+u,o=-y+M,e>=0&&h>e&&o>=0&&i>o&&a(t[e],n[o]),(c===y||0>c&&c===-y||c>0&&c===1-y)&&(l=f,f=-g,g=l),c+=f,y+=g}function long2tile(t,n){return Math.floor((t+180)/360*Math.pow(2,n))}function lat2tile(t,n){return Math.floor((1-Math.log(Math.tan(t*Math.PI/180)+1/Math.cos(t*Math.PI/180))/Math.PI)/2*Math.pow(2,n))}function tile2long(t,n){return t/Math.pow(2,n)*360-180}function tile2lat(t,n){var a=Math.PI-2*Math.PI*t/Math.pow(2,n);return 180/Math.PI*Math.atan(.5*(Math.exp(a)-Math.exp(-a)))}function range(t,n){var a,r=[];for(a=t;n>a;a++)r.push(a);return r}var tiles=function(){function t(){var t=Math.max(Math.log(a)/Math.LN2-8,0),l=Math.round(t+e),h=Math.pow(2,t-l+8),i=[(r[0]-a/2)/h,(r[1]-a/2)/h],u=[],M=range(Math.max(0,Math.floor(-i[0])),Math.max(0,Math.ceil(n[0]/h-i[0]))),c=range(Math.max(0,Math.floor(-i[1])),Math.max(0,Math.ceil(n[1]/h-i[1])));return o?spiralOrder(M,c,function(t,n){u.push([t,n,l])}):c.forEach(function(t){M.forEach(function(n){u.push([n,t,l])})}),{tiles:u,scale:h,translate:i}}var n=[960,500],a=256,r=[n[0]/2,n[1]/2],e=0,o=!1;return t.size=function(a){return arguments.length?(n=a,t):n},t.scale=function(n){return arguments.length?(a=n,t):a},t.translate=function(n){return arguments.length?(r=n,t):r},t.zoomDelta=function(n){return arguments.length?(e=+n,t):e},t.spiral=function(n){return arguments.length?(o=n?!0:!1,t):o},t};tiles.locationToTile=function(t,n,a){return{x:long2tile(n,a),y:lat2tile(n,a),z:a}},tiles.tileToBoundingBox=function(t,n,a){return[[tile2long(t,a),tile2lat(n,a)],[tile2long(t+1,a),tile2lat(n+1,a)]]},module.exports=tiles;